import{c as I,m as R}from"./vuex.esm-bundler.2e787911.js";import{b as q}from"./WpTable.6ebd2781.js";import{_ as O}from"./default-i18n.ab92175e.js";import"./constants.449145d5.js";import{_ as x,r as u,o as g,c as v,a as l,t as o,f as c,d as n,w as r,F as N,b as m,B as $,y as p,D as C}from"./_plugin-vue_export-helper.1252226d.js";import{D as E}from"./index.fef507ce.js";import"./SaveChanges.03404395.js";import{D as T}from"./Date.461dc30a.js";import{a as z,c as Y}from"./Caret.21cdd163.js";import{S as B}from"./Exclamation.b493e7b4.js";import{c as A,i as M}from"./helpers.de7566d0.js";import{B as W}from"./DatePicker.b55bde46.js";import{C as J,b as j}from"./index.c8bcf9e5.js";import{C as F}from"./Index.67d5329e.js";import{C as H}from"./Table.9acc0e22.js";import{C as K}from"./Card.8a160590.js";import{C as Q}from"./Tooltip.ce066015.js";import"./Index.25975920.js";import"./Row.3c6833bf.js";import"./RequiresUpdate.52f5acf2.js";import"./postContent.d5640333.js";import"./cleanForSlug.3cf2e377.js";import"./isArrayLikeObject.da221b94.js";import"./html.14f2a8b9.js";import"./_commonjsHelpers.f84db168.js";import"./isUndefined.6aa45a19.js";import"./_getAllKeys.cdde2cc1.js";import"./_getTag.2bfb1432.js";import"./debounce.6bfba81c.js";import"./toNumber.d6fd2789.js";import"./isEqual.8d0db5de.js";import"./_baseIsEqual.7ca684b6.js";import"./Slide.8b22672f.js";const G=""+window.__aioseoDynamicImportPreload__("images/import-from-csv.fa7a7c61.png");const S={page:{url:null,priority:{label:"0.7",value:"0.7"},frequency:{label:O("weekly","all-in-one-seo-pack"),value:"weekly"},lastModified:E.now().toFormat("MM/dd/yyyy")}},X={emits:["cancel","process-page-add-and-update","process-page-edit"],mixins:[T],components:{BaseDatePicker:W,CoreAlert:J,CoreModal:F,SvgCircleCheck:z,SvgCircleClose:Y,SvgCircleExclamation:B},data(){return{csvFileImage:G,priorityOptionsValues:[],frequencyOptionsValues:[],filename:"",file:"",loading:!1,showImportModal:!1,page:A(S.page),errors:{url:{invalid:null,exists:null},upload:!1},isLoading:!1,strings:{placeholder:this.$t.sprintf(this.$t.__("Enter a page URL, e.g. %1$s",this.$td),`${this.$aioseo.urls.home}/new-page`),pageUrl:this.$t.__("Page URL",this.$td),priority:this.$t.__("Priority",this.$td),frequency:this.$t.__("Frequency",this.$td),lastModified:this.$t.__("Last Modified",this.$td),addPage:this.$t.__("Add Page",this.$td),importFromCSV:this.$t.__("Import from CSV",this.$td),saveChanges:this.$t.__("Save Changes",this.$td),cancel:this.$t.__("Cancel",this.$td),importAdditionalPages:this.$t.__("Import Additional Pages",this.$td),modalDescription:this.$t.sprintf(this.$t.__("You can import additional page URL's to your sitemap using a CSV file. The following 4 columns are required: %1$sPage URL, Priority, Frequency, Date Modified.%2$s",this.$td),"<strong>","</strong>"),downloadSampleFile:this.$t.__("Download Sample CSV File",this.$td),imgAltText:this.$t.__("CSV example file",this.$td),fileUploadPlaceholder:this.$t.__("Import from CSV file...",this.$td),chooseAFile:this.$t.__("Choose a File",this.$td),import:this.$t.__("Import",this.$td),csvFileTypeRequired:this.$t.__("The file that you've currently selected is not a CSV file.",this.$td),invalidCSV:this.$t.__("Unable to read CSV file. Please check if the file is valid and try again.",this.$td),errors:{url:{invalid:this.$t.__("Please enter a valid URL.",this.$td),exists:this.$t.__("URL already exists.",this.$td)}}},sampleCSVData:`Page URL,Priority,Frequency,Date Modified\r
https://aioseo.com/pricing/,0.0,weekly,01/30/2022`}},methods:{...I(["updateAdditionalPages"]),addPage(){const e=[...this.pages];e.unshift(JSON.stringify(this.page)),this.updateAdditionalPages(e),this.page=A(S.page),this.errors.url.invalid=null,this.$emit("process-page-add-and-update")},editPage(e,s){if(this.page[e]=s,!M(this.page.url)&&this.page.url){this.errors.url.invalid=!0;return}if(this.pageExists(this.page.url)&&!this.inTable){this.errors.url.invalid=!1,this.errors.url.exists=!0;return}this.errors.url.invalid=!1,this.errors.url.exists=!1,this.inTable&&this.$emit("process-page-edit",this.page)},updatePage(e){const s=[...this.pages];s[this.getPaginatedIndex(e)]=JSON.stringify(this.page),this.updateAdditionalPages(s),this.$emit("process-page-add-and-update"),this.$emit("cancel",!0)},pageExists(e){return this.getParsedPages().some(({url:s})=>s===e)},reset(){this.errors.upload=!1,this.filename="",this.file=""},triggerFileUpload(){this.reset(),this.$refs.file.$el.querySelector("input").focus(),this.$refs.file.$el.querySelector("input").click()},async submitFile(){this.loading=!0;try{const e=await this.parseFile(),s=this.pages;e.forEach(a=>{const f=this.prepareAdditionalPage(a);f&&s.unshift(JSON.stringify(f))}),this.updateAdditionalPages(s)}catch{this.errors.upload=this.strings.invalidCSV}this.reset(),this.page=A(S.page),this.showImportModal=!1,this.loading=!1},prepareAdditionalPage(e){const s=A(S.page);return e.forEach(a=>{if(M(a)&&!this.pageExists(a)){s.url=a;return}if(this.priorityOptionsValues.includes(a)){s.priority.label=s.priority.value=a;return}if(this.frequencyOptionsValues.includes(a.toLowerCase())){s.frequency.label=s.frequency.value=a.toLowerCase();return}isNaN(T.parse(a))||(s.lastModified=a)}),s.url!==null?s:!1},parseFile(){const e=new FileReader;return e.readAsText(this.file),new Promise((s,a)=>{e.onerror=()=>{e.abort(),a(new DOMException)},e.onload=()=>{const t=e.result.split(/[\r\n]/).map(i=>i.split(","));s(t)}})},handleFileUpload(){this.file=this.$refs.file.$el.querySelector("input").files[0],this.file&&(this.filename=this.file.name,this.file.type!=="text/csv"&&(this.errors.upload=this.strings.csvFileTypeRequired))},closeImportModal(){this.reset(),this.showImportModal=!1}},computed:{...R({pages:e=>e.options.sitemap.general.additionalPages.pages}),importValidated(){return this.file.type==="text/csv"}},props:{inTable:Boolean,row:Object,index:Number,getPaginatedIndex:Function,getParsedPages:Function,rowPage:{type:Object,default(){return{}}},editedPage:{type:Object,default(){return{}}}},mounted(){this.priorityOptionsValues=this.$constants.PRIORITY_OPTIONS.map(e=>e.value),this.frequencyOptionsValues=this.$constants.FREQUENCY_OPTIONS.map(e=>e.value),this.inTable&&(this.page=this.rowPage!==this.editedPage?this.rowPage:this.editedPage)}},Z={key:0,class:"page-input-header"},ee={class:"page-url"},te={class:"page-priority"},se={class:"page-frequency"},ie={class:"page-last-modified"},ae={class:"page-row"},le={class:"page-url"},oe={class:"append-icon"},re={class:"page-priority"},ne={class:"page-frequency"},de={class:"page-last-modified"},ue={class:"page-input-footer"},ge={key:0},pe={key:1},he={class:"aioseo-modal-body import-additional-pages"},ce={class:"alert"},me=["innerHTML"],_e=["href"],fe=["src","alt"],Pe={class:"file-upload"};function ye(e,s,a,f,t,i){const k=u("svg-circle-close"),w=u("svg-circle-check"),L=u("svg-circle-exclamation"),P=u("base-input"),y=u("core-alert"),b=u("base-select"),D=u("base-date-picker"),_=u("base-button"),h=u("core-modal");return g(),v("div",{class:$(["additional-pages-input",{"in-table":a.inTable}])},[a.inTable?c("",!0):(g(),v("div",Z,[l("div",ee,o(t.strings.pageUrl),1),l("div",te,o(t.strings.priority),1),l("div",se,o(t.strings.frequency),1),l("div",ie,o(t.strings.lastModified),1)])),l("div",ae,[l("div",le,[n(P,{modelValue:t.page.url,onKeyup:s[0]||(s[0]=d=>i.editPage("url",d.target.value)),size:"medium",placeholder:t.strings.placeholder,class:$(this.errors.url.invalid&&"aioseo-error"||this.page.url&&this.errors.url.exists&&"aioseo-warning"||this.page.url&&"aioseo-active")},{"append-icon":r(()=>[l("div",oe,[t.isLoading?c("",!0):(g(),v(N,{key:0},[t.errors.url.invalid?(g(),m(k,{key:0})):c("",!0),!t.errors.url.invalid&&!t.errors.url.exists&&t.page.url?(g(),m(w,{key:1})):c("",!0),t.errors.url.exists&&t.page.url?(g(),m(L,{key:2})):c("",!0)],64))])]),_:1},8,["modelValue","placeholder","class"]),this.errors.url.invalid?(g(),m(y,{key:0,type:"red",size:"small"},{default:r(()=>[p(o(t.strings.errors.url.invalid),1)]),_:1})):c("",!0),this.errors.url.exists?(g(),m(y,{key:1,type:"yellow",size:"small"},{default:r(()=>[p(o(t.strings.errors.url.exists),1)]),_:1})):c("",!0)]),l("div",re,[n(b,{size:"medium",modelValue:t.page.priority,"onUpdate:modelValue":s[1]||(s[1]=d=>i.editPage("priority",d)),options:e.$constants.PRIORITY_OPTIONS},null,8,["modelValue","options"])]),l("div",ne,[n(b,{size:"medium",modelValue:t.page.frequency,"onUpdate:modelValue":s[2]||(s[2]=d=>i.editPage("frequency",d)),options:e.$constants.FREQUENCY_OPTIONS},null,8,["modelValue","options"])]),l("div",de,[n(D,{type:"date",size:"large",dateFormat:"m/d/Y",defaultValue:e.dateStringToLocalJs(t.page.lastModified),onChange:s[3]||(s[3]=d=>i.editPage("lastModified",e.dateJsToLocal(d,"MM/dd/yyyy")))},null,8,["defaultValue"])])]),l("div",ue,[a.inTable?(g(),v("div",ge,[n(_,{type:"blue",size:"medium",onClick:s[4]||(s[4]=d=>i.updatePage(a.index)),disabled:t.errors.url.invalid||t.errors.url.exists||!t.page.url},{default:r(()=>[p(o(t.strings.saveChanges),1)]),_:1},8,["disabled"]),n(_,{type:"gray",size:"medium",onClick:s[5]||(s[5]=d=>e.$emit("cancel",!0))},{default:r(()=>[p(o(t.strings.cancel),1)]),_:1})])):c("",!0),a.inTable?c("",!0):(g(),v("div",pe,[n(_,{type:"blue",size:"small-table",onClick:i.addPage,disabled:t.errors.url.invalid||t.errors.url.exists||!t.page.url},{default:r(()=>[p(o(t.strings.addPage),1)]),_:1},8,["onClick","disabled"]),n(_,{type:"black",size:"small-table",onClick:s[6]||(s[6]=d=>t.showImportModal=!0)},{default:r(()=>[p(o(t.strings.importFromCSV),1)]),_:1})]))]),t.showImportModal?(g(),m(h,{key:1,onClose:i.closeImportModal},{headerTitle:r(()=>[p(o(t.strings.importAdditionalPages),1)]),body:r(()=>[l("div",he,[l("div",ce,[l("p",{innerHTML:t.strings.modalDescription},null,8,me),l("a",{download:"aioseo-additional-pages-sample.csv",href:"data:text/csv;charset=utf-8,"+t.sampleCSVData},o(t.strings.downloadSampleFile),9,_e)]),l("img",{src:e.$getAssetUrl(t.csvFileImage),alt:t.strings.imgAltText},null,8,fe),t.errors.upload?(g(),m(y,{key:0,type:"red",class:"import-error"},{default:r(()=>[n(k),p(" "+o(t.errors.upload),1)]),_:1})):c("",!0),l("div",Pe,[n(P,{modelValue:t.filename,"onUpdate:modelValue":s[7]||(s[7]=d=>t.filename=d),size:"medium",onFocus:i.triggerFileUpload,placeholder:t.strings.fileUploadPlaceholder,class:$({"aioseo-error":t.errors.upload})},null,8,["modelValue","onFocus","placeholder","class"]),n(_,{type:"black",size:"medium",onClick:i.triggerFileUpload},{default:r(()=>[p(o(t.strings.chooseAFile),1)]),_:1},8,["onClick"])]),n(P,{type:"file",value:t.file,"onUpdate:modelValue":i.handleFileUpload,ref:"file"},null,8,["value","onUpdate:modelValue"]),n(_,{type:"blue",size:"medium",class:"import",onClick:i.submitFile,disabled:!t.file||!i.importValidated,loading:t.loading},{default:r(()=>[p(o(t.strings.import),1)]),_:1},8,["onClick","disabled","loading"])])]),_:1},8,["onClose"])):c("",!0)],2)}const be=x(X,[["render",ye]]);const ve={mixins:[q],components:{AddAdditionalPage:be,CoreWpTable:H,CoreCard:K,CoreTooltip:Q,CoreModal:F,SvgTrash:j},data(){return{tableId:"sitemap-additional-pages",changeItemsPerPageSlug:"sitemapAdditionalPages",page:{},editedPage:{},resultsPerPage:10,searchResults:null,deletingRow:!1,activeRow:-1,showDeleteModal:!1,shouldDeleteURL:null,selectedRows:null,bulkOptions:[{label:this.$t.__("Delete",this.$td),value:"delete"}],strings:{placeholder:this.$t.sprintf(this.$t.__("Enter a page URL, e.g. %1$s",this.$td),`${this.$aioseo.urls.home}/new-page`),pageUrl:this.$t.__("Page URL",this.$td),priority:this.$t.__("Priority",this.$td),frequency:this.$t.__("Frequency",this.$td),lastModified:this.$t.__("Last Modified",this.$td),searchUrls:this.$t.__("Search URLs",this.$td),edit:this.$t.__("Edit",this.$td),delete:this.$t.__("Delete",this.$td),addPage:this.$t.__("Add Page",this.$td),importFromCSV:this.$t.__("Import from CSV",this.$td),always:this.$t.__("always",this.$td),additionalPages:this.$t.__("Additional Pages",this.$td),additionalPagesTooltip:this.$t.__("You can use this section to add any URLs to your sitemap which aren't a part of your WordPress installation. For example, if you have a contact form that you would like to be included on your sitemap you can enter the information manually.",this.$td),areYouSureDeleteLink:this.$t.__("Are you sure you want to delete this page?",this.$td),areYouSureDeleteLinks:this.$t.__("Are you sure you want to delete these pages?",this.$td),thisWillRemoveLink:this.$t.__("This will permanently remove this page from the additional pages sitemap.",this.$td),thisWillRemoveLinks:this.$t.__("This will permanently remove the selected pages from the additional pages sitemap.",this.$td),yesDeleteLink:this.$t.__("Delete Page",this.$td),yesDeleteLinks:this.$t.__("Delete Selected Pages",this.$td),noChangedMind:this.$t.__("No, I changed my mind",this.$td)}}},computed:{...R(["options","additionalPages"]),...R({pages:e=>e.options.sitemap.general.additionalPages.pages}),currentPages(){return this.searchResults||this.getParsedPages()},rows(){const e=this.currentPages.map(a=>({url:a.url,priority:a.priority&&a.priority.label?a.priority.label:"",frequency:a.frequency&&a.frequency.label?a.frequency.label:"",lastModified:a.lastModified})),s=this.pageNumber===1?0:(this.pageNumber-1)*this.resultsPerPage;return e.slice(s,s+this.resultsPerPage)},totals(){return{page:1,pages:Math.ceil(this.currentPages.length/this.resultsPerPage),total:this.currentPages.length}},columns(){return[{slug:"url",label:this.$t.__("Page URL",this.$td)},{slug:"priority",label:this.$t.__("Priority",this.$td),width:"90px"},{slug:"frequency",label:this.$t.__("Frequency",this.$td),width:"90px"},{slug:"lastModified",label:this.$t.__("Last Modified",this.$td),width:"110px"},{slug:"page-actions",label:"",width:"40px"}]},areYouSureDeleteLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.areYouSureDeleteLinks:this.strings.areYouSureDeleteLink},yesDeleteLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.yesDeleteLinks:this.strings.yesDeleteLink},thisWillRemoveLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.thisWillRemoveLinks:this.strings.thisWillRemoveLink}},methods:{...I(["updateAdditionalPages"]),fetchData(){return Promise.resolve()},processSearch(e){if(this.$refs.table.editRow(null),this.pageNumber=1,e===""){this.searchResults=null,this.searchTerm=null;return}e||(e=this.searchTerm),this.wpTableLoading=!0,this.searchResults=this.getParsedPages().filter(s=>s.url.includes(e)),this.searchTerm=e,this.wpTableLoading=!1},processBulkAction({action:e,selectedRows:s}){s.length&&e==="delete"&&(this.showDeleteModal=!0,this.shouldDeleteURL=s)},processPageDelete(){this.wpTableLoading=!0,Array.isArray(this.shouldDeleteURL)?this.shouldDeleteURL.forEach(e=>{this.deletePage(e)}):this.deletePage(this.shouldDeleteURL),this.showDeleteModal=!1,this.wpTableLoading=!1},deletePage(e){const s=[];this.getParsedPages().forEach(a=>{a.url!==e&&s.push(JSON.stringify(a))}),this.updateAdditionalPages(s),this.searchResults&&this.processSearch()},maybeProcessDelete(e){this.showDeleteModal=!0,this.shouldDeleteURL=e},processPageEdit(e){this.editedPage=e},processPageAddAndUpdate(){this.searchTerm&&this.processSearch(this.searchTerm)},rowPage(e){return this.searchResults?this.searchResults[this.getPaginatedIndex(e)]:this.getParsedPages()[this.getPaginatedIndex(e)]},getPaginatedIndex(e){return(this.pageNumber-1)*this.resultsPerPage+e},getParsedPages(){return this.pages.map(e=>JSON.parse(e))}}},ke={class:"aioseo-additional-pages"},we=["onClick"],Ce={class:"row-actions"},Ae=["onClick"],Se=["onClick"],Le={class:"page-actions"},De={class:"aioseo-modal-body delete"},Ue={class:"reset-description"};function $e(e,s,a,f,t,i){const k=u("base-toggle"),w=u("add-additional-page"),L=u("svg-trash"),P=u("core-tooltip"),y=u("core-wp-table"),b=u("base-button"),D=u("core-modal"),_=u("core-card");return e.options.sitemap.general.enable?(g(),m(_,{key:0,slug:"additionalPages",toggles:e.options.sitemap.general.additionalPages.enable},{header:r(()=>[n(k,{modelValue:e.options.sitemap.general.additionalPages.enable,"onUpdate:modelValue":s[0]||(s[0]=h=>e.options.sitemap.general.additionalPages.enable=h)},null,8,["modelValue"]),l("span",null,o(t.strings.additionalPages),1)]),tooltip:r(()=>[p(o(t.strings.additionalPagesTooltip),1)]),default:r(()=>[l("div",ke,[n(w,{getPaginatedIndex:i.getPaginatedIndex,getParsedPages:i.getParsedPages,onProcessPageAddAndUpdate:i.processPageAddAndUpdate},null,8,["getPaginatedIndex","getParsedPages","onProcessPageAddAndUpdate"]),(g(),m(y,{ref:"table",class:"additional-pages-table",id:t.tableId,"bulk-options":t.bulkOptions,columns:i.columns,"initial-items-per-page":e.$aioseo.settings.tablePagination.sitemapAdditionalPages,"initial-page-number":e.pageNumber,key:e.wpTableKey,loading:e.wpTableLoading,rows:i.rows,"search-label":t.strings.searchUrls,"show-search":!0,totals:i.totals,"show-items-per-page":"",onPaginate:e.processPagination,onProcessBulkAction:i.processBulkAction,onProcessChangeItemsPerPage:e.processChangeItemsPerPage,onSearch:i.processSearch,onSortColumn:e.processSort},{url:r(({row:h,index:d,editRow:U})=>[l("a",{class:"post-title",href:"#",onClick:C(V=>U(d),["prevent","stop"])},o(h.url),9,we),l("div",Ce,[l("span",null,[l("a",{class:"edit",href:"#",onClick:C(V=>U(d),["prevent","stop"])},[l("span",null,o(t.strings.edit),1)],8,Ae),p(" | ")]),l("span",null,[l("a",{class:"delete",href:"#",onClick:C(V=>i.maybeProcessDelete(h.url),["prevent","stop"])},[l("span",null,o(t.strings.delete),1)],8,Se)])])]),"edit-row":r(({index:h,editRow:d})=>[n(w,{index:h,rowPage:i.rowPage(h),editedPage:t.editedPage,getPaginatedIndex:i.getPaginatedIndex,getParsedPages:i.getParsedPages,inTable:"",onCancel:U=>d(null),onProcessPageAddAndUpdate:i.processPageAddAndUpdate,onProcessPageEdit:i.processPageEdit},null,8,["index","rowPage","editedPage","getPaginatedIndex","getParsedPages","onCancel","onProcessPageAddAndUpdate","onProcessPageEdit"])]),"page-actions":r(({row:h})=>[l("div",Le,[n(P,{type:"action"},{tooltip:r(()=>[p(o(t.strings.delete),1)]),default:r(()=>[n(L,{onClick:d=>i.maybeProcessDelete(h.url)},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["id","bulk-options","columns","initial-items-per-page","initial-page-number","loading","rows","search-label","totals","onPaginate","onProcessBulkAction","onProcessChangeItemsPerPage","onSearch","onSortColumn"])),t.showDeleteModal?(g(),m(D,{key:0,"no-header":"",onClose:s[3]||(s[3]=h=>t.showDeleteModal=!1)},{body:r(()=>[l("div",De,[l("button",{class:"close",onClick:s[1]||(s[1]=C(h=>t.showDeleteModal=!1,["stop"]))}),l("h3",null,o(i.areYouSureDeleteLink),1),l("div",Ue,o(t.strings.thisWillRemoveLink),1),n(b,{type:"blue",size:"medium",onClick:i.processPageDelete,loading:t.deletingRow},{default:r(()=>[p(o(i.yesDeleteLink),1)]),_:1},8,["onClick","loading"]),n(b,{type:"gray",size:"medium",onClick:s[2]||(s[2]=h=>t.showDeleteModal=!1)},{default:r(()=>[p(o(t.strings.noChangedMind),1)]),_:1})])]),_:1})):c("",!0)])]),_:1},8,["toggles"])):c("",!0)}const ut=x(ve,[["render",$e]]);export{ut as default};

import{m as S,a as A,b as F}from"./vuex.esm-bundler.2e787911.js";import{C as M}from"./Blur.fd3c040c.js";import{C as E}from"./Card.8a160590.js";import{G as N,a as G}from"./Row.3c6833bf.js";import{G as q,S as j}from"./SeoStatisticsOverview.74a5914d.js";import{_ as T,r as n,o as c,c as k,d as l,f as b,b as $,w as s,a as m,D as x,t as h,y,e as I,B as V}from"./_plugin-vue_export-helper.1252226d.js";import{K as z}from"./KeywordsGraph.e125908e.js";import{d as K}from"./helpers.de7566d0.js";import{b as W,L as J}from"./WpTable.6ebd2781.js";import"./default-i18n.ab92175e.js";import"./constants.449145d5.js";import"./index.fef507ce.js";import"./SaveChanges.03404395.js";import{P as L}from"./PostTypes.9ab32454.js";import{S as U,T as Q,c as X}from"./Statistic.3c49fce7.js";import{C as Y}from"./Tooltip.ce066015.js";import{C as H}from"./Table.9acc0e22.js";import{C as O}from"./Index.25975920.js";import{C as Z,b as tt}from"./Caret.21cdd163.js";import{R as et}from"./RequiredPlans.7747ff8a.js";import"./index.c8bcf9e5.js";import"./Slide.8b22672f.js";import"./RequiresUpdate.52f5acf2.js";import"./postContent.d5640333.js";import"./cleanForSlug.3cf2e377.js";import"./isArrayLikeObject.da221b94.js";import"./html.14f2a8b9.js";import"./Index.67d5329e.js";import"./_commonjsHelpers.f84db168.js";import"./_arrayEach.56a9f647.js";import"./_getAllKeys.cdde2cc1.js";import"./_getTag.2bfb1432.js";import"./vue.runtime.esm-bundler.9b388507.js";const st={components:{Graph:q},computed:{...S("search-statistics",["data","loading"]),series(){var d,r;if(!((r=(d=this.data)==null?void 0:d.keywords)!=null&&r.distribution))return[];const t=this.data.keywords.distribution;return[{name:this.$t.__("Keywords",this.$td),data:[{x:this.$t.__("Top 3 Position",this.$td),y:t.top3,fillColor:"#005AE0"},{x:this.$t.__("4-10 Position",this.$td),y:t.top10,fillColor:"#00AA63"},{x:this.$t.__("11-50 Position",this.$td),y:t.top50,fillColor:"#F18200"},{x:this.$t.__("50-100 Position",this.$td),y:t.top100,fillColor:"#DF2A4A"}]}]}}},ot={class:"aioseo-search-statistics-keywords-distribution-graph"};function it(t,d,r,p,o,a){const u=n("graph");return c(),k("div",ot,[l(u,{series:a.series,loading:t.loading.keywords,preset:"keywordsDistribution"},null,8,["series","loading"])])}const rt=T(st,[["render",it]]);const nt={components:{CoreLoader:Z,CoreWpTable:H,Statistic:U},mixins:[L],props:{index:{type:Number,required:!0},postDetail:{type:Boolean,required:!1,default:!1}},data(){return{loading:!1}},computed:{...S("search-statistics",["data"]),postColumns(){return[{slug:"post_title",label:this.$t.__("Title",this.$td),width:"100%"},{slug:"clicks",label:this.$t.__("Clicks",this.$td),width:"120px"},{slug:"ctr",label:this.$t.__("Avg. CTR",this.$td),width:"120px"},{slug:"impressions",label:this.$t.__("Impressions",this.$td),width:"120px"},{slug:"position",label:this.$t.__("Position",this.$td),width:"120px"}]},keywords(){return this.postDetail?this.data.postDetail.keywords.paginated.rows:this.data.keywords.paginated.rows},row(){return this.keywords[this.index]}},methods:{...A("search-statistics",["getPagesByKeywords"]),openPostDetail(t){this.$router.push({path:"/post-detail",query:{postId:t.postId,previousRoute:this.$route.name}})}},mounted(){var t,d;!this.row||(d=(t=this.row)==null?void 0:t.pages)!=null&&d.length||(this.loading=!0,this.getPagesByKeywords([this.row.keyword]).then(r=>{this.loading=!1;const p=r[this.row.keyword];p&&(this.postDetail?this.data.postDetail.keywords.paginated.rows[this.index].pages=Object.values(p).slice(0,10):this.data.keywords.paginated.rows[this.index].pages=Object.values(p).slice(0,10))}))}},at={class:"keyword-inner"},lt={key:0,class:"keyword-inner-loading"},ct={class:"post-title"},dt=["onClick"],ht={key:1,class:"post-title"},pt={key:0,class:"row-actions"},ut=["href"],_t=["href"];function ft(t,d,r,p,o,a){const u=n("core-loader"),f=n("statistic"),g=n("core-wp-table");return c(),k("div",at,[o.loading?(c(),k("div",lt,[l(u,{dark:""})])):b("",!0),a.row.pages&&!o.loading?(c(),$(g,{ref:"table",class:"posts-table",key:1,columns:a.postColumns,rows:a.row.pages,"show-header":!1,"show-bulk-actions":!1,"show-table-footer":!1},{post_title:s(({row:e})=>[m("div",ct,[e.postId?(c(),k("a",{key:0,href:"#",onClick:x(P=>a.openPostDetail(e),["prevent"])},h(e.postTitle),9,dt)):(c(),k("span",ht,h(e.postTitle),1))]),e.postId?(c(),k("div",pt,[m("span",null,[m("a",{class:"view",href:e.context.permalink,target:"_blank"},[m("span",null,h(t.viewPost(e.context.postType.singular)),1)],8,ut),y(" | ")]),m("span",null,[m("a",{class:"edit",href:e.context.editLink,target:"_blank"},[m("span",null,h(t.editPost(e.context.postType.singular)),1)],8,_t)])])):b("",!0)]),clicks:s(({row:e})=>[y(h(t.$numbers.compactNumber(e.clicks)),1)]),ctr:s(({row:e})=>[y(h(e.ctr)+"% ",1)]),impressions:s(({row:e})=>[y(h(t.$numbers.compactNumber(e.impressions)),1)]),position:s(({row:e})=>[e.difference.comparison?(c(),$(f,{key:0,type:"position",total:e.position,difference:e.difference.position},null,8,["total","difference"])):b("",!0)]),_:1},8,["columns","rows"])):b("",!0)])}const mt=T(nt,[["render",ft]]);const gt={components:{CoreTooltip:Y,CoreWpTable:H,Cta:O,KeywordInner:mt,Statistic:U,SvgCaret:tt},mixins:[L,W,Q],data(){return{tableId:"aioseo-search-statistics-keywords-table",activeRow:-1,showUpsell:!1,isPreloading:!1,isFetching:!1,interval:null,strings:{ctaButtonText:this.$t.__("Upgrade to Pro and Unlock Access Control",this.$td),ctaHeader:this.$t.sprintf(this.$t.__("Access Control is only available for licensed %1$s %2$s users.",this.$td),"AIOSEO","Pro")}}},props:{keywords:Object,loading:{type:Boolean,default(){return!1}},showHeader:{type:Boolean,default(){return!0}},showTableFooter:Boolean,showItemsPerPage:Boolean,columns:{type:Array,default(){return["keyword","clicks","ctr","impressions","position","diffPosition","buttons"]}},appendColumns:{type:Object,default(){return{}}},postDetail:{type:Boolean,default(){return!1}},refreshOnLoad:{type:Boolean,default(){return!0}},page:{type:String,default(){return""}}},computed:{...F(["isUnlicensed"]),...S("search-statistics",["data","isConnected"]),changeItemsPerPageSlug(){return this.postDetail?"searchStatisticsPostDetailKeywords":"searchStatisticsKeywordRankings"},allColumns(){var r,p;const t=X(this.columns),d=((p=(r=this.keywords)==null?void 0:r.filters)==null?void 0:p.find(o=>o.active))||{};return this.appendColumns[d.slug||"all"]&&t.push(this.appendColumns[d.slug||"all"]),t},tableColumns(){return[{slug:"keyword",label:this.$t.__("Keyword",this.$td),sortable:this.isSortable,sortDir:this.orderBy==="keyword"?this.orderDir:"asc",sorted:this.orderBy==="keyword"},{slug:"clicks",label:this.$t.__("Clicks",this.$td),width:"80px",sortable:this.isSortable,sortDir:this.orderBy==="clicks"?this.orderDir:"asc",sorted:this.orderBy==="clicks"},{slug:"ctr",label:this.$t.__("Avg. CTR",this.$td),width:"100px",sortable:this.isSortable,sortDir:this.orderBy==="ctr"?this.orderDir:"asc",sorted:this.orderBy==="ctr"},{slug:"impressions",label:this.$t.__("Impressions",this.$td),width:"120px",sortable:this.isSortable,sortDir:this.orderBy==="impressions"?this.orderDir:"asc",sorted:this.orderBy==="impressions"},{slug:"position",label:this.$t.__("Position",this.$td),width:"85px",sortable:this.isSortable,sortDir:this.orderBy==="position"?this.orderDir:"asc",sorted:this.orderBy==="position"},{slug:"diffDecay",label:this.$t.__("Diff",this.$td),width:"95px"},{slug:"diffPosition",label:this.$t.__("Diff",this.$td),width:"80px"},{slug:"buttons",label:"",width:this.hasSlot("buttons")?"240px":"40px"}].filter(t=>this.allColumns.includes(t.slug))},isSortable(){return this.filter==="all"&&this.$isPro&&!this.isUnlicensed}},methods:{...A("search-statistics",["getPagesByKeywords","updateKeywords","updatePostDetailKeywords"]),decodeHTMLEntities:K,isRowActive(t){return t===this.activeRow},toggleRow(t){if(this.activeRow===t){this.activeRow=-1;return}this.activeRow=t},fetchData(t){return this.isPreloading=!1,this.isFetching=!0,this.page!==""&&(t={...t,page:this.page}),this.postDetail?this.updatePostDetailKeywords(t).finally(()=>{this.isFetching=!1}):this.updateKeywords(t).finally(()=>{this.isFetching=!1})},hasSlot(t="default"){return!!this.$slots[t]},shouldLimitText(t){return 120<K(t).length},maybePreloadPages(){if(!(!this.isConnected||this.isPreloading)){if(this.isFetching&&!this.interval){this.interval=setInterval(()=>{this.isFetching||(clearInterval(this.interval),this.maybePreloadPages())},100);return}this.isPreloading=!0,this.preloadPages().then(()=>{this.isPreloading=!1})}},preloadPages(){var o,a,u,f,g;let t=(a=(o=this.data.keywords)==null?void 0:o.paginated)==null?void 0:a.rows;this.postDetail&&(t=(g=(f=(u=this.data.postDetail)==null?void 0:u.keywords)==null?void 0:f.paginated)==null?void 0:g.rows);const d=[];t.forEach(e=>{e.pages||d.push(e.keyword)});const r=[];for(let e=0;e<d.length;e+=10)r.push(d.slice(e,e+10));const p=[];return r.forEach(e=>{p.push(new Promise(P=>{this.getPagesByKeywords(e).then(v=>{Object.entries(v).forEach(D=>{const[i,_]=D,w=t.findIndex(B=>B.keyword===i);if(w===-1)return;const C=Object.values(_).slice(0,10);this.postDetail?this.data.postDetail.keywords.paginated.rows[w].pages=C:this.data.keywords.paginated.rows[w].pages=C})}).finally(()=>{P()})}))}),Promise.all(p)}},mounted(){this.maybePreloadPages()},updated(){this.maybePreloadPages()}},yt={class:"aioseo-search-statistics-keywords-table"},wt={class:"keyword"},kt=["onClick"],bt=["onClick"],$t={class:""};function Pt(t,d,r,p,o,a){const u=n("core-tooltip"),f=n("statistic"),g=n("svg-caret"),e=n("base-button"),P=n("keyword-inner"),v=n("cta"),D=n("core-wp-table");return c(),k("div",yt,[l(D,{ref:"table",class:"keywords-table",id:o.tableId,columns:a.tableColumns,rows:Object.values(r.keywords.rows),totals:r.keywords.totals,filters:r.keywords.filters,"additional-filters":r.keywords.additionalFilters,loading:r.loading,"initial-page-number":t.pageNumber,"initial-search-term":t.searchTerm,"initial-items-per-page":t.$aioseo.settings.tablePagination[a.changeItemsPerPageSlug],"show-header":r.showHeader,"show-bulk-actions":!1,"show-table-footer":r.showTableFooter,"show-items-per-page":r.showItemsPerPage,"show-pagination":"","blur-rows":o.showUpsell,onFilterTable:t.processFilter,onProcessAdditionalFilters:t.processAdditionalFilters,onPaginate:t.processPagination,onProcessChangeItemsPerPage:t.processChangeItemsPerPage,onSearch:t.processSearch,onSortColumn:t.processSort},{keyword:s(({row:i,index:_,editRow:w})=>[m("div",wt,[a.shouldLimitText(i.keyword)?(c(),$(u,{key:0},{tooltip:s(()=>[y(h(a.decodeHTMLEntities(i.keyword)),1)]),default:s(()=>[m("a",{class:"limit-line",href:"#",onClick:x(C=>{w(_),a.toggleRow(_)},["prevent"])},h(a.decodeHTMLEntities(i.keyword)),9,kt)]),_:2},1024)):(c(),k("a",{key:1,href:"#",onClick:x(C=>{w(_),a.toggleRow(_)},["prevent"])},h(a.decodeHTMLEntities(i.keyword)),9,bt))])]),clicks:s(({row:i})=>[y(h(i.clicks),1)]),ctr:s(({row:i})=>[y(h(t.$numbers.compactNumber(i.ctr))+"% ",1)]),impressions:s(({row:i})=>[y(h(t.$numbers.compactNumber(i.impressions)),1)]),position:s(({row:i})=>[y(h(Math.round(i.position).toFixed(0)),1)]),diffPosition:s(({row:i})=>[i.difference.comparison?(c(),$(f,{key:0,type:"position",difference:i.difference.position,showCurrent:!1,"tooltip-offset":"-100px,0"},null,8,["difference"])):b("",!0)]),diffDecay:s(({row:i})=>[i.difference.comparison?(c(),$(f,{key:0,type:"decay",difference:i.difference.decay,showCurrent:!1,"tooltip-offset":"-100px,0"},null,8,["difference"])):b("",!0)]),buttons:s(({row:i,index:_,column:w,editRow:C})=>[m("div",$t,[I(t.$slots,"buttons",{row:i,column:w,index:_}),l(e,{type:"gray",class:V(["toggle-row-button",{active:a.isRowActive(_)}]),onClick:B=>{C(_),a.toggleRow(_)}},{default:s(()=>[l(g)]),_:2},1032,["class","onClick"])])]),"edit-row":s(({index:i})=>[l(P,{index:i,postDetail:r.postDetail},null,8,["index","postDetail"])]),cta:s(()=>[o.showUpsell?(c(),$(v,{key:0,"cta-link":t.$links.getPricingUrl("search-statistics","search-statistics-upsell"),"button-text":o.strings.ctaButtonText,"learn-more-link":t.$links.getUpsellUrl("search-statistics","search-statistics-upsell","home")},{"header-text":s(()=>[y(h(o.strings.ctaHeader),1)]),_:1},8,["cta-link","button-text","learn-more-link"])):b("",!0)]),tablenav:s(()=>[I(t.$slots,"tablenav")]),_:3},8,["id","columns","rows","totals","filters","additional-filters","loading","initial-page-number","initial-search-term","initial-items-per-page","show-header","show-table-footer","show-items-per-page","blur-rows","onFilterTable","onProcessAdditionalFilters","onPaginate","onProcessChangeItemsPerPage","onSearch","onSortColumn"])])}const vt=T(gt,[["render",Pt]]),Ct={components:{CoreBlur:M,CoreCard:E,GridColumn:N,GridRow:G,KeywordsDistributionGraph:rt,KeywordsGraph:z,KeywordsTable:vt,SeoStatisticsOverview:j},data(){return{strings:{keywordPositionsCard:this.$t.__("Keyword Positions",this.$td),keywordPositionsTooltip:this.$t.__("This graph is a visual representation of how well <strong>keywords are ranking in search results over time</strong> based on their position and average CTR. This can help you understand the performance of keywords and identify any trends or fluctuations.",this.$td),keywordPerformanceCard:this.$t.__("Keyword Performance",this.$td),keywordPerformanceTooltip:this.$t.__("This table displays the performance of keywords that your site ranks for over time, including metrics such as impressions, click-through rate, and average position in search results. It allows for easy analysis of how keywords are performing and identification of any underperforming keywords that may need to be optimized or replaced.",this.$td)},defaultKeywords:{rows:[],totals:{page:0,pages:0,total:0}}}},computed:{...S("search-statistics",["data"])}},Tt={class:"aioseo-search-statistics-dashboard"},Dt=["innerHTML"],St=["innerHTML"];function xt(t,d,r,p,o,a){const u=n("seo-statistics-overview"),f=n("keywords-graph"),g=n("grid-column"),e=n("keywords-distribution-graph"),P=n("grid-row"),v=n("core-card"),D=n("keywords-table"),i=n("core-blur");return c(),$(i,null,{default:s(()=>[m("div",Tt,[l(P,null,{default:s(()=>[l(g,null,{default:s(()=>[l(v,{slug:"keywordPositions","header-text":o.strings.keywordPositionsCard,toggles:!1,"no-slide":""},{tooltip:s(()=>[m("span",{innerHTML:o.strings.keywordPositionsTooltip},null,8,Dt)]),default:s(()=>[l(u,{statistics:["keywords","impressions","position"],"show-graph":!1,view:"side-by-side"}),l(P,null,{default:s(()=>[l(g,{md:"6"},{default:s(()=>[l(f,{"legend-style":"simple"})]),_:1}),l(g,{md:"6"},{default:s(()=>[l(e)]),_:1})]),_:1})]),_:1},8,["header-text"]),l(v,{slug:"keywordPerformance","header-text":o.strings.keywordPerformanceCard,toggles:!1,"no-slide":""},{tooltip:s(()=>[m("span",{innerHTML:o.strings.keywordPerformanceTooltip},null,8,St)]),default:s(()=>{var _,w;return[l(D,{keywords:((w=(_=t.data)==null?void 0:_.keywords)==null?void 0:w.paginated)||o.defaultKeywords,ref:"table","show-items-per-page":"","show-table-footer":""},null,8,["keywords"])]}),_:1},8,["header-text"])]),_:1})]),_:1})])]),_:1})}const Bt=T(Ct,[["render",xt]]);const It={components:{Blur:Bt,Cta:O,RequiredPlans:et},data(){return{strings:{ctaButtonText:this.$t.sprintf(this.$t.__("Upgrade to %1$s and Unlock Search Statistics",this.$td),"Pro"),ctaHeader:this.$t.sprintf(this.$t.__("Search Statistics is only for licensed %1$s %2$s users.",this.$td),"AIOSEO","Pro"),ctaDescription:this.$t.__("Connect your site to Google Search Console to receive insights on how content is being discovered. Identify areas for improvement and drive traffic to your website.",this.$td),thisFeatureRequires:this.$t.__("This feature requires one of the following plans:",this.$td),feature1:this.$t.__("Search traffic insights",this.$td),feature2:this.$t.__("Track page rankings",this.$td),feature3:this.$t.__("Track keyword rankings",this.$td),feature4:this.$t.__("Speed tests for individual pages/posts",this.$td)}}},computed:{...F(["isUnlicensed"])}},Kt={class:"aioseo-search-statistics-keyword-rankings"};function Rt(t,d,r,p,o,a){const u=n("blur"),f=n("required-plans"),g=n("cta");return c(),k("div",Kt,[l(u),l(g,{"cta-link":t.$links.getPricingUrl("search-statistics","search-statistics-upsell","keyword-rankings"),"button-text":o.strings.ctaButtonText,"learn-more-link":t.$links.getUpsellUrl("search-statistics","keyword-rankings","home"),"feature-list":[o.strings.feature1,o.strings.feature2,o.strings.feature3,o.strings.feature4],"align-top":""},{"header-text":s(()=>[y(h(o.strings.ctaHeader),1)]),description:s(()=>[l(f,{"core-feature":["search-statistics","keyword-rankings"]}),y(" "+h(o.strings.ctaDescription),1)]),_:1},8,["cta-link","button-text","learn-more-link","feature-list"])])}const R=T(It,[["render",Rt]]),At={mixins:[J],components:{KeywordRankings:R,Lite:R}},Ft={class:"aioseo-search-statistics-keyword-rankings"};function Lt(t,d,r,p,o,a){const u=n("keyword-rankings",!0),f=n("lite");return c(),k("div",Ft,[t.shouldShowMain("search-statistics","keyword-rankings")?(c(),$(u,{key:0})):b("",!0),t.shouldShowUpgrade("search-statistics","keyword-rankings")||t.shouldShowLite?(c(),$(f,{key:1})):b("",!0)])}const me=T(At,[["render",Lt]]);export{me as default};
